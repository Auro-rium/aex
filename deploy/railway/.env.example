# =============================================================
# AEX v2.1 â€” Railway + Neon Production Environment Variables
# Set these as Railway service variables in the dashboard.
# =============================================================

# --- Required: PostgreSQL (Neon) ---
# Format: postgresql://<user>:<password>@<neon-host>/<db>?sslmode=require
AEX_PG_DSN=postgresql://<user>:<password>@<neon-host>/<db>?sslmode=require

# --- Required: Admin control key (for /admin/control/* endpoints) ---
AEX_ADMIN_CONTROL_KEY=<strong-random-secret>

# --- Required: Model config dir (models.yaml is bundled in Docker image) ---
AEX_CONFIG_DIR=/etc/aex/config

# --- Startup behaviour ---
AEX_STARTUP_STRICT=1                  # Fail fast if DB/config unavailable
AEX_LOG_LEVEL=INFO                    # DEBUG | INFO | WARNING | ERROR

# --- Database tuning (optional, these are the defaults) ---
AEX_DB_CONNECT_TIMEOUT_SECONDS=5
AEX_DB_STATEMENT_TIMEOUT_MS=20000
AEX_DB_LOCK_TIMEOUT_MS=5000
AEX_SERIALIZABLE_RETRY_MAX=5

# --- Optional: Redis (rate limiting + short-lived locks) ---
# If not set, AEX falls back to PostgreSQL-based rate limiting.
AEX_REDIS_URL=redis://default:<password>@<redis-host>:6379

# --- Optional: LLM Provider keys (forwarded to upstream providers) ---
OPENAI_API_KEY=sk-...
GROQ_API_KEY=gsk_...

# --- Optional: Admitted request tuning ---
AEX_ADMISSION_TIMEOUT_MS=2500
AEX_PROVIDER_TIMEOUT_MS=30000
AEX_WEBHOOK_TIMEOUT_MS=5000

# --- Optional: Recovery sweep interval ---
AEX_RECOVERY_SWEEP_SECONDS=15

# --- Optional: CORS / host restrictions ---
# Comma-separated. Leave unset to allow all origins (development mode).
# AEX_CORS_ORIGINS=https://your-dashboard.example.com
# AEX_ALLOWED_HOSTS=your-app.railway.app,your-custom-domain.com

# --- Optional: Alert thresholds ---
AEX_ALERT_STALE_RESERVATIONS=20
AEX_ALERT_NON_TERMINAL_EXECUTIONS=50
AEX_ALERT_DENIED_RATIO=0.50
AEX_ALERT_PROVIDER_429=30
AEX_ALERT_WINDOW_MINUTES=10

# --- SDK defaults (for agents calling AEX via SDK) ---
AEX_ENABLE=1
AEX_MODE=proxy
AEX_BASE_URL=https://<your-app>.railway.app
